<!DOCTYPE html>
<html>

<head>
    <title>ðŸ’¬ Instant Chat App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        body {
            margin: 0;
            padding-bottom: 3rem;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #0d1418;
        }

        .messageContainer {
            width: 75%;
            display: flex;
            flex-direction: column;
        }

        .message {
            border-radius: 4px;
            padding: 0.5rem 1rem;
            width: auto;
            color: #d4d5d7;
            margin-top: 2rem;
        }

        .receivedMessage {
            float: left;
            background-color: #262d31;
            max-width: 50%;
        }

        .sentMessage {
            max-width: 40%;
            float: right;
            background-color: #056162;
            margin-right: 0;
            align-self: flex-end;
        }

        .botMessage {
            max-width: 75%;
            align-self: center;
            background-color: #223138;
            padding: 0.2rem 0.5rem;
            font-size: 0.75rem;
        }

        #form {
            background-color: #1e2428;
            padding: 0.25rem;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: row;
            height: 4rem;
            box-sizing: border-box;
            width: 100%;
            margin: 0 auto;
            justify-content: center;
            align-items: center;
        }

        .messageBox {
            width: 90%;
            color: #d4d5d7;
            border: 0;
            border-radius: 1000px;
            background-color: #33383b;
            max-width: 70%;
            height: 75%;
            padding-left: 1.5%;
            padding-right: 1.5%;
        }

        .messageBox:focus {
            outline: 0;
            border: 1px #056162 solid;
        }

        .sendButton {
            color: #d4d5d7;
            height: 75%;
            width: 10%;
            border: 0;
            border-radius: 4px;
            max-width: 10%;
            background-color: transparent;
        }
    </style>
</head>

<body>
    <!-- message, receivedMessage, sentMessage, botMessage -->
    <div class="messageContainer container">
    </div>
    <form id="form" action="">
        <input id="input" autocomplete="off" class="messageBox" placeholder="Type a message...">
        <button class="sendButton">Send</button>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        // var nick = prompt("Enter your nickname");
        var socket = io();
        var form = document.getElementById('form');
        var input = document.getElementById('input');

        socket.on("welcomeMessage", function (message) {
            console.log(message);
        })

        //emitting new messages if submitted
        form.addEventListener('submit', function (event) {
            event.preventDefault();
            console.log(event);
            if (input.value) {
                var message = input.value;
                //emitting message to the server
                socket.emit("sentMessage", message);
                input.value = '';
                //dom manipulation for sent messages
                const div = document.createElement("div");
                div.classList.add("message");
                div.classList.add("sentMessage");
                div.innerHTML = message;
                document.querySelector(".messageContainer").appendChild(div);
            }
        });

        //listening for incoming messages
        socket.on("receivedMessage", function (message) {
            console.log(message);
            //dom manipulation for received messages
            const div = document.createElement("div");
            div.classList.add("message");
            div.classList.add("receivedMessage");
            div.innerHTML = message;
            document.querySelector(".messageContainer").appendChild(div);
        })
    </script>
</body>

</html>